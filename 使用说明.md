# 📄 公文格式调整工具 - 使用说明

## 📋 功能简介

本工具按照 **GB/T 9704-2012《党政机关公文格式》** 标准，自动调整 Word 文档格式。

### ✨ 主要功能

1. **自动识别文档结构**
   - 主标题（方正小标宋22号，居中）
   - 主送机关（仿宋16号，顶格）
   - 一级标题：一、二、三、（黑体16号）
   - 二级标题：（一）（二）（三）（楷体加粗16号）
   - 三级标题：1. 2. 3.（仿宋加粗16号）
   - 四级标题：(1) (2) (3)（仿宋16号）
   - 正文（仿宋16号）
   - 署名和日期（仿宋16号，右对齐）

2. **智能修正编号**
   - 自动修正标题层级跳跃
   - 自动修正编号不连续
   - 清除多余的标点符号
   - 清除多重编号（如"（一）1、"）

3. **附件处理**
   - 附件独立编号（从"一、"重新开始）
   - 附件列表格式规范化
   - 附件前自动分页

4. **格式统一**
   - 页边距：上3.7cm 下3.5cm 左2.8cm 右2.6cm
   - 首行缩进：2字符（32磅）
   - 行距：固定值30磅
   - 删除标题上方多余空行

---

## 🚀 快速开始

### 方式一：双击运行（推荐）

#### macOS 用户
1. 双击 `一键运行.command`
2. 拖拽 Word 文档到终端窗口
3. 按回车键开始处理

#### Windows 用户
1. 双击 `一键运行.bat`
2. 拖拽 Word 文档到命令行窗口
3. 按回车键开始处理

### 方式二：命令行运行

```bash
# 进入工具目录
cd /path/to/codebuddy_gongwen

# 运行程序
python3 gongwen_formatter_cli.py

# 拖拽文档或输入文档路径，按回车
```

---

## 📦 安装依赖

### 首次使用需要安装 Python 库

```bash
pip3 install -r requirements_simple.txt
```

或者手动安装：

```bash
pip3 install python-docx
```

---

## 💡 使用技巧

### 1. 批量处理
程序处理完一个文档后，可以继续拖入下一个文档，无需重启。

### 2. 输出文件
处理后的文件会保存在原文件同目录下，文件名前加 `done_` 前缀。

**示例：**
- 原文件：`测试文档.docx`
- 输出文件：`done_测试文档.docx`

### 3. 支持的格式
- 仅支持 `.docx` 格式（Word 2007及以上版本）
- 不支持 `.doc` 格式（旧版Word）

### 4. 特殊情况处理

#### 表格内容
- 表格中的内容不会被处理（保持原样）

#### 图片
- 图片段落自动居中对齐

#### "一是"、"二是" 格式
- 段落中的"一是"、"二是"等会自动加粗
- 正文其他部分保持正常格式

---

## ⚠️ 注意事项

### 1. 字体要求
工具使用以下字体，请确保系统已安装：
- **方正小标宋简体**（主标题）
- **黑体**（一级标题）
- **楷体_GB2312**（二级标题）
- **仿宋_GB2312**（三级标题、四级标题、正文）

> 💡 如果缺少字体，Word 会自动使用替代字体，但显示效果可能不符合标准。

### 2. 备份原文件
虽然工具会生成新文件（不覆盖原文件），但建议处理重要文档前先备份。

### 3. 附件处理
- 附件部分会自动换页
- 附件内的标题编号独立于正文（从"一、"重新开始）

---

## 🔧 常见问题

### Q1: 提示"找不到文件"
**A:** 请确保：
- 文件路径正确
- 文件名中没有特殊字符
- 文件确实是 `.docx` 格式

### Q2: 处理后格式不对
**A:** 可能原因：
- 原文档使用了表格布局（表格内容不处理）
- 原文档包含大量手动格式（如手动空格、Tab键）
- 标题编号格式不规范

### Q3: 中文显示乱码
**A:** macOS/Windows 命令行默认支持中文，如果乱码请检查：
- 终端编码设置（应为 UTF-8）
- Python 版本（建议 Python 3.7+）

### Q4: 双击 .command 文件没反应（macOS）
**A:** 首次使用需要赋予执行权限：
```bash
chmod +x 一键运行.command
```

---

## 📞 技术支持

如遇到问题，请检查：
1. Python 版本：`python3 --version`（需要 3.6+）
2. 依赖安装：`pip3 list | grep python-docx`
3. 文件权限：确保对文件有读写权限

---

## 📚 格式标准参考

本工具严格按照 **GB/T 9704-2012《党政机关公文格式》** 标准：

| 元素 | 字体 | 字号 | 对齐方式 | 缩进 |
|------|------|------|----------|------|
| 主标题 | 方正小标宋简体 | 22号 | 居中 | 无 |
| 主送机关 | 仿宋_GB2312 | 16号 | 左对齐 | 顶格 |
| 一级标题 | 黑体 | 16号 | 左对齐 | 首行缩进2字符 |
| 二级标题 | 楷体_GB2312 | 16号（加粗） | 左对齐 | 首行缩进2字符 |
| 三级标题 | 仿宋_GB2312 | 16号（加粗） | 左对齐 | 首行缩进2字符 |
| 四级标题 | 仿宋_GB2312 | 16号 | 左对齐 | 首行缩进2字符 |
| 正文 | 仿宋_GB2312 | 16号 | 左对齐 | 首行缩进2字符 |
| 署名 | 仿宋_GB2312 | 16号 | 右对齐 | 无 |
| 日期 | 仿宋_GB2312 | 16号 | 右对齐 | 无 |

---

## 🎉 使用愉快！

如有问题或建议，欢迎反馈。
